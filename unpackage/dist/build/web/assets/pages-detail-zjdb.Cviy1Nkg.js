import{u as a,W as e,R as l,r as t,l as s,D as u,c,w as o,E as n,i,o as f,b as d,d as r,x as v,v as _,q as m,t as p,F as b,J as h,K as k,Q as g,X as y,y as C,S as w}from"./index-DszEigh-.js";import{o as N}from"./uni-app.es.yxr7YjqI.js";import{P as j,A as x,b as I,c as R,a as D}from"./uni-popup.C2LCYpza.js";import{h as q}from"./request.CCTae_dV.js";import{u as A,a as T,d as E,b as B,c as F,I as L}from"./attachmentList.DtrauFz4.js";import{_ as M}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-nav-bar.CQxrnHAm.js";import"./uni-icons.Bqff-X7n.js";import"./uni-easyinput.BqZ0_ocZ.js";const P=M({__name:"zjdb",setup(M){let P;a((a=>({"7506afe5":n(K)})));let S=null;N((()=>{var a,l,t;P=null==(t=null==(l=null==(a=e())?void 0:a.proxy)?void 0:l.getOpenerEventChannel)?void 0:t.call(l),S=a=>{U.value=a.type,z.value=a.order,na(),ea()},P.on("open-detail",S)})),l((()=>{P&&S&&P.off("open-detail",S),S=null}));const U=t(""),z=t({}),G=t([]),H=t([]),J=s((()=>"Running"==oa.value.wfstatus?"流转中":"Completed"==oa.value.wfstatus?"已审批":"")),{listHeight:K}=A({headerSelector:".header-stickt",iosFit:!0}),{inputDialogRef:O,inputDialogRequired:Q,inputDialogTitle:W,inputDialogPlaceholder:X,handleInputConfirm:V,handleInputCancel:Y,onReject:Z,onApprove:$,approvalRecordList:aa,getApprovalRecord:ea}=T({itemDetail:z,currentType:U,successMessage:"已审批",autoGoBack:!0,autoRefresh:!0}),la=u({[j]:!0,[x]:!0,[I]:!0}),ta=a=>{la[a]=!la[a]},sa=a=>la[a],ua=s((()=>({pending:{procCode:z.value.procDefCode,workitemid:z.value.workItemId},completed:{procCode:z.value.procDefCode,wfInstanceId:z.value.wfinstanceId}}[U.value]))),ca=t([{label:"付款单位",value:"",key:"fromCompanyName"},{label:"付款开户行",value:"",key:"fromBankName"},{label:"付款账号",value:"",key:"fromAccountNumber"},{label:"收款单位",value:"",key:"toCompanyName"},{label:"收款开户行",value:"",key:"toBankName"},{label:"收款账号",value:"",key:"toAccountNumber"},{label:"调拨金额",value:"",key:"transferAmount"},{label:"调拨事项",value:"",key:"content"}]),oa=t({}),na=()=>{q.get(R[U.value],ua.value).then((a=>{var e;let l=(null==(e=a.data)?void 0:e.data)||{};oa.value=(null==l?void 0:l.wfrequestfundtransfer)||{},ca.value.forEach((a=>{a.value="number"==typeof oa.value[a.key]?D(oa.value[a.key]):oa.value[a.key]||""})),oa.value.toCompanyName&&G.value.push(oa.value.toCompanyName);let t=((null==l?void 0:l.attachments)||[]).map((a=>({fileTagName:a.fileTagName,fileName:a.fileName,fileUrl:a.fileUrl,id:a.attachmentId})));H.value=[{fileTagName:"其他",children:[]}];const s=new Map;H.value.forEach((a=>{s.set(a.fileTagName,a)})),t.forEach((a=>{const e=s.get(a.fileTagName);e&&e.children.push(a)}))}))};return(a,e)=>{const l=i,t=C,s=w;return f(),c(l,{class:"detail-page"},{default:o((()=>[d(l,{class:"header-stickt"},{default:o((()=>[d(E),d(l,{class:"hero-card"},{default:o((()=>[d(l,{class:"hero-header"},{default:o((()=>[d(l,{class:"project-name"},{default:o((()=>[d(l,{class:"project-name-1"},{default:o((()=>[r(v(z.value.taskName),1)])),_:1}),d(l,{class:"project-name-1"},{default:o((()=>[r(" 上海城投公路投资（集团）有限公司 ")])),_:1})])),_:1}),d(l,{class:"amount-box"},{default:o((()=>[d(l,{class:"amount-label"},{default:o((()=>[r("调拨金额")])),_:1}),d(l,{class:"amount-value"},{default:o((()=>[d(t,{class:"amount-value-symbol"},{default:o((()=>[r("¥")])),_:1}),d(t,{class:"amount-value-number"},{default:o((()=>[r(v(n(D)(oa.value.transferAmount)),1)])),_:1})])),_:1})])),_:1})])),_:1}),d(l,{class:_(["hero-tags",{"hero-tags-width":"pending"!=U.value}])},{default:o((()=>[(f(!0),m(b,null,p(G.value,((a,e)=>(f(),c(l,{class:"tag",key:e},{default:o((()=>[r(v(a),1)])),_:2},1024)))),128))])),_:1},8,["class"]),h(d(l,{class:"hero-actions"},{default:o((()=>[d(l,{class:"btn outline",onClick:n(Z)},{default:o((()=>[r("打回")])),_:1},8,["onClick"]),d(l,{class:"btn primary",onClick:n($)},{default:o((()=>[r("通过")])),_:1},8,["onClick"])])),_:1},512),[[k,"pending"===U.value]]),h(d(l,{class:"wfstatus-actions"},{default:o((()=>[r(v(J.value),1)])),_:1},512),[[k,"completed"===U.value&&("Running"==oa.value.wfstatus||"Completed"==oa.value.wfstatus)]])])),_:1})])),_:1}),d(s,{"scroll-y":"true",class:"scroller"},{default:o((()=>[d(l,{class:"section"},{default:o((()=>[d(l,{class:"section-title"},{default:o((()=>[d(t,{class:"section-title-vertical"}),d(t,{class:"section-title-text"},{default:o((()=>[r("基本信息")])),_:1})])),_:1}),sa(n(j))?(f(),c(l,{key:0,class:"account-info-section"},{default:o((()=>[d(l,{style:{height:"10rpx"}}),d(l,{class:"account-card"},{default:o((()=>[d(l,{class:"account-info-block"},{default:o((()=>[d(l,{class:"account-info-row"},{default:o((()=>[d(t,{class:"account-info-label"},{default:o((()=>[r(v(ca.value[0].label),1)])),_:1}),d(t,{class:"account-info-value"},{default:o((()=>[r(v(ca.value[0].value),1)])),_:1})])),_:1}),d(l,{class:"account-info-row"},{default:o((()=>[d(t,{class:"account-info-label"},{default:o((()=>[r(v(ca.value[1].label),1)])),_:1}),d(t,{class:"account-info-value"},{default:o((()=>[r(v(ca.value[1].value),1)])),_:1})])),_:1}),d(l,{class:"account-info-row"},{default:o((()=>[d(t,{class:"account-info-label"},{default:o((()=>[r(v(ca.value[2].label),1)])),_:1}),d(t,{class:"account-info-value"},{default:o((()=>[r(v(ca.value[2].value),1)])),_:1})])),_:1})])),_:1})])),_:1}),d(l,{class:"account-card margin_1"},{default:o((()=>[d(l,{class:"account-info-block"},{default:o((()=>[d(l,{class:"account-info-row"},{default:o((()=>[d(t,{class:"account-info-label"},{default:o((()=>[r(v(ca.value[3].label),1)])),_:1}),d(t,{class:"account-info-value"},{default:o((()=>[r(v(ca.value[3].value),1)])),_:1})])),_:1}),d(l,{class:"account-info-row"},{default:o((()=>[d(t,{class:"account-info-label"},{default:o((()=>[r(v(ca.value[4].label),1)])),_:1}),d(t,{class:"account-info-value"},{default:o((()=>[r(v(ca.value[4].value),1)])),_:1})])),_:1}),d(l,{class:"account-info-row"},{default:o((()=>[d(t,{class:"account-info-label"},{default:o((()=>[r(v(ca.value[5].label),1)])),_:1}),d(t,{class:"account-info-value"},{default:o((()=>[r(v(ca.value[5].value),1)])),_:1})])),_:1})])),_:1})])),_:1}),d(l,{class:"account-card margin_1"},{default:o((()=>[d(l,{class:"account-info-block"},{default:o((()=>[d(l,{class:"account-info-row"},{default:o((()=>[d(t,{class:"account-info-label"},{default:o((()=>[r(v(ca.value[6].label),1)])),_:1}),d(t,{class:"account-info-value"},{default:o((()=>[r(v(ca.value[6].value),1)])),_:1})])),_:1}),d(l,{class:"account-info-row"},{default:o((()=>[d(t,{class:"account-info-label"},{default:o((()=>[r(v(ca.value[7].label),1)])),_:1}),d(t,{class:"account-info-value"},{default:o((()=>[r(v(ca.value[7].value),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})):g("",!0)])),_:1}),d(l,{class:"section"},{default:o((()=>[d(l,{class:"section-title-2",onClick:e[0]||(e[0]=a=>ta(n(I)))},{default:o((()=>[d(l,{class:"section-title-2-left"},{default:o((()=>[d(t,{class:"section-title-vertical"}),d(t,{class:"section-title-text"},{default:o((()=>[r("附件")])),_:1})])),_:1}),d(l,{class:_(["section-title-2-right",{active:sa(n(I))}])},null,8,["class"])])),_:1}),d(y,{name:"collapse"},{default:o((()=>[sa(n(I))?(f(),c(l,{key:0,class:"attachment-section"},{default:o((()=>[d(B,{list:H.value},null,8,["list"])])),_:1})):g("",!0)])),_:1})])),_:1}),d(l,{class:"section"},{default:o((()=>[d(l,{class:"section-title-2",onClick:e[1]||(e[1]=a=>ta(n(x)))},{default:o((()=>[d(l,{class:"section-title-2-left"},{default:o((()=>[d(t,{class:"section-title-vertical"}),d(t,{class:"section-title-text"},{default:o((()=>[r("审批记录")])),_:1})])),_:1}),d(l,{class:_(["section-title-2-right",{active:sa(n(x))}])},null,8,["class"])])),_:1}),d(y,{name:"collapse"},{default:o((()=>[sa(n(x))?(f(),c(l,{key:0,class:"approval-record-section"},{default:o((()=>[d(F,{list:n(aa)},null,8,["list"])])),_:1})):g("",!0)])),_:1})])),_:1})])),_:1}),d(L,{ref_key:"inputDialogRef",ref:O,required:n(Q),title:n(W),placeholder:n(X),onConfirm:n(V),onCancel:n(Y)},null,8,["required","title","placeholder","onConfirm","onCancel"])])),_:1})}}},[["__scopeId","data-v-65efc481"]]);export{P as default};
